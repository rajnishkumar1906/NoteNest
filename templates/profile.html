{% extends 'base.html' %}
{% load static %}
{% block title %}Rajnish IceCreams{% endblock %}

{% block content %}
<section class="container py-5">
  <div class="row g-4">
    <!-- User Info -->
    <div class="col-md-4">
      <div class="card shadow-sm p-3 text-center">
        <img src="{% static 'images/team1.jpg' %}" class="rounded-circle mb-3" width="120" alt="User Profile">
        <h4 class="fw-bold">Rajnish Kumar</h4>
        <p class="text-muted">johndoe@example.com</p>
        <h6 class="mt-3 fw-bold">Address</h6>
        <p class="text-muted mb-0">123 Sweet Street</p>
        <p class="text-muted mb-0">Candy Town, IceCream State</p>
        <p class="text-muted mb-0">ZIP 456789</p>
      </div>
    </div>

    <!-- Cart -->
    <div class="col-md-8">
      <h3 class="fw-bold mb-4">Your Cart</h3>
      <div class="d-flex flex-column gap-3">

        <!-- Cart Item -->
        <div class="card shadow-sm p-3 d-flex flex-row align-items-center justify-content-between">
          <div class="d-flex align-items-center gap-3">
            <img src="{% static 'images/chocolate.png' %}" width="80" class="rounded" alt="Chocolate">
            <div>
              <h5 class="mb-1">Chocolate</h5>
              <p class="mb-0 text-success fw-bold">$3.50 / scoop</p>
            </div>
          </div>
          <div class="d-flex align-items-center gap-2">
            <button class="btn btn-outline-secondary btn-sm qty-btn">−</button>
            <input type="number" class="form-control form-control-sm text-center qty-input" value="2" min="1" style="width:60px;">
            <button class="btn btn-outline-secondary btn-sm qty-btn">+</button>
          </div>
          <div>
            <h6 class="mb-0 total">$7.00</h6>
          </div>
          <button class="btn btn-outline-danger btn-sm remove-btn">Remove</button>
        </div>

        <!-- Cart Item -->
        <div class="card shadow-sm p-3 d-flex flex-row align-items-center justify-content-between">
          <div class="d-flex align-items-center gap-3">
            <img src="{% static 'images/mango.png' %}" width="80" class="rounded" alt="Mango">
            <div>
              <h5 class="mb-1">Mango</h5>
              <p class="mb-0 text-success fw-bold">$3.75 / scoop</p>
            </div>
          </div>
          <div class="d-flex align-items-center gap-2">
            <button class="btn btn-outline-secondary btn-sm qty-btn">−</button>
            <input type="number" class="form-control form-control-sm text-center qty-input" value="1" min="1" style="width:60px;">
            <button class="btn btn-outline-secondary btn-sm qty-btn">+</button>
          </div>
          <div>
            <h6 class="mb-0 total">$3.75</h6>
          </div>
          <button class="btn btn-outline-danger btn-sm remove-btn">Remove</button>
        </div>
      </div>

      <!-- Cart Summary -->
      <div class="card shadow-sm p-3 mt-4">
        <h5 class="fw-bold">Cart Summary</h5>
        <hr>
        <p class="d-flex justify-content-between mb-1"><span>Subtotal:</span> $<span id="subtotal">10.75</span></p>
        <p class="d-flex justify-content-between mb-1"><span>Tax (5%):</span> $<span id="tax">0.54</span></p>
        <h5 class="d-flex justify-content-between fw-bold"><span>Total:</span> $<span id="total">11.29</span></h5>
        <a href="#" class="btn btn-success btn-lg w-100 mt-3">Checkout</a>
      </div>

    </div>
  </div>
</section>

<script>
function updateTotals() {
    let subtotal = 0;
    document.querySelectorAll('.card.d-flex').forEach(row => {
        const priceElem = row.querySelector('p.text-success');
        const totalElem = row.querySelector('.total');
        if (!priceElem || !totalElem) return;
        const price = parseFloat(priceElem.textContent.replace('$',''));
        const qty = parseInt(row.querySelector('.qty-input').value);
        const total = price * qty;
        totalElem.textContent = '$' + total.toFixed(2);
        subtotal += total;
    });
    const tax = subtotal * 0.05;
    const total = subtotal + tax;
    document.getElementById('subtotal').textContent = subtotal.toFixed(2);
    document.getElementById('tax').textContent = tax.toFixed(2);
    document.getElementById('total').textContent = total.toFixed(2);
}

// Quantity buttons
document.querySelectorAll('.qty-btn').forEach(btn => {
    btn.addEventListener('click', e => {
        const input = btn.parentElement.querySelector('.qty-input');
        let val = parseInt(input.value);
        if (btn.textContent === '+') val++;
        else if (btn.textContent === '−' && val > 1) val--;
        input.value = val;
        updateTotals();
    });
});

// Manual input change
document.querySelectorAll('.qty-input').forEach(input => {
    input.addEventListener('input', updateTotals);
});

// Remove item
document.querySelectorAll('.remove-btn').forEach(btn => {
    btn.addEventListener('click', e => {
        btn.closest('.card.d-flex').remove();
        updateTotals();
    });
});
</script>

<style>
.card img { object-fit: cover; }
.qty-btn { padding: 0 12px; }
</style>
{% endblock %}
